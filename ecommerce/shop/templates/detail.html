{% extends 'base.html' %} <!-- permet d'avoir l'entête et le menu sur toutes les pages -->

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-6">
            <img src="{{ evenement_object.image.url }}" width="500px" height="500px" alt="{{ evenement_object.title }}" class="img-fluid">
        </div>
        <div class="col-md-6">
            <h2 class="text-warning">{{ evenement_object.title }}</h2>
            <p>{{ evenement_object.description }}</p>
            <form method="post">
                {% csrf_token %}
                <label for="formule">Choisir une formule:</label>
                <select name="formule" id="formule-select">
                    {% for formule in formules_with_prices %}
                        <option value="{{ formule.id }}" data-price-multiplier="{{ formule.price }}">{{ formule.formule }} - {{ formule.price|floatformat:2 }} €</option>
                    {% endfor %}
                </select>
                <!--<p id="event-price">{{ formules_with_prices.0.price|floatformat:2 }} €</p>  Prix initial a changer car actuellement n'affiche pas le prix initial --> 
                <button type="submit" class="btn btn-success shopping_cart">Ajouter au panier</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('formule-select').addEventListener('change', function() {
        var selectedOption = this.options[this.selectedIndex];
        var price = parseFloat(selectedOption.getAttribute('data-price-multiplier'));
        document.getElementById('event-price').textContent = price.toFixed(2) + ' €';
    });
</script>
{% endblock %}

{% block js %}
    <script type="text/javascript">
        console.log('test');
        //on regarde si le panier est nul. si c'est le cas création d'un panier
        if(localStorage.getItem('panier')==null){
            var panier ={};
        // si c'est pas le cas on ajoute     
        }else{
            panier=JSON.parse(localStorage.getItem('panier'));
        }

        // on veut recuperer le click de l'utilisateur sur le bouton panier
        $(document).on('click', '.shopping_cart',function(){
            console.log('ajouter')
        })


    </script>

{% endblock %}